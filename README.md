# chatlabs-timetrack

[Ссылка на гугл таблицу](https://docs.google.com/spreadsheets/d/13pVw6nIs6YKAaKLhaW4s7Kq6FDCi5HaAZbb-SFS3SKA/edit?usp=sharing)


## Описание таблицы
- `B3:D19` - Учет рабочего времени
- `E3` - Сумма отработанных часов
- `F3` - Cтавка (руб/час)
- `G3` - Размер выплаты
- `K3:K19` - Список проектов

## Базовый вариант
1. Копируем таблицу к себе на диск
2. Заполняем `K3:K19` названиями проектов
3. Добавляем отработанные часы в B3:D19

## Продвинутый вариант
1. Копируем таблицу к себе на диск
2. Заполняем `K3:K19` названиями проектов
3. Заполняем `L3:L19` ID проектов из Pendulums. Чтобы узнать ID проекта, нужно зайти на страницу просмотра его статистики.
URL страницы будет в формате `https://app.pendulums.io/activities/<ProjectID>`
4. В ячейку `F22` записывем Cookie (берем из любого запроса к Pendulums)
5. В ячейку `F23` записываем значение параметра users из запроса к
`https://app.pendulums.io/api/projects/<ProjectID>/stats/hours`
6. Добавляем скрипт. Для этого нажимаем `Расширения > Apps Script`, затем вставляем содержимое файла `script.gs` этого репозитория в открывшийся редактор.
7. В переменную `sheetUrl` (строка 62) кладем ссылку на нашу таблицу.
8. В переменную `sheetName` (строка 63) кладем название листа (вкладки) в нашей таблице.
9. Сохраняем скрипт, возвращаемся к таблице, нажимаем ПКМ на картинку "Добавить" (`G21:G23`), нажимаем на три точки, нажимаем "Назначить скрипт". Вводим `addWork`, нажимаем ОК.
10. Теперь при нажатии на кнопку "Добавить" в таблицу будут автоматически добавлены все отработанные часы по проектам, указанным в `K3:L19` за день, указанный в `F21`.

---
Приятного пользования и больших выплат!

Rostislaww, ChatLabs